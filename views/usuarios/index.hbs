<nav style="--bs-breadcrumb-divider: '>';" aria-label="breadcrumb">
  <ol class="breadcrumb">
    <li class="breadcrumb-item"><a href="/dashboard">Dashboard</a></li>
    <li class="breadcrumb-item active" aria-current="page">Usuários</li>
  </ol>
</nav>


<main>
    <section class="py-2 text-center container">
        <div class="row py-lg-5">
            <div class="col-lg-6 col-md-8 mx-auto container_box">
                <p>Estes são os usuários cadastrados.</p>
                <div id="tabelaUsuarios">
                    {{#if usuarios}}
                    <table class="table striped align-middle">
                        <thead>
                            <tr>
                                <th>Nome completo</th>
                                <th>E-mail</th>
                                <th>Tipo</th>
                                <th>Criado em</th>
                                <th>Ações</th>
                            </tr>
                        </thead>
                        <tbody>
                            {{#each usuarios}}
                            <tr>
                                <td>{{nome}}</td>
                                <td>{{email}}</td>
                                <td><span class="dash-status">{{tipo}}</span></td>
                                <td>{{formatDate criadoEm 'DD/MM/yyyy'}}</td>

                                <td>
                                    <a href="/usuarios/edit/{{_id}}" class="btn btn-float">
                                        <i class="fas fa-edit"></i>
                                    </a>
                                    <form action="/usuarios/{{_id}}" method="POST" id="delete-form">
                                        <input type="hidden" name="_method" value="DELETE">
                                        <button type="submit" class="btn red">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </form>
                                </td>
                            </tr>
                            {{/each}}
                        </tbody>
                    </table>
                    {{else}}
                        <p>Não há usuários cadastrados.</p>
                    {{/if}}
                </div>
                <div>
                    <button class="btn btn-primary btn-sm my-2 filter-button" id="gerarExcel">Gerar Excel</button>
                </div>
            </div>
        </div>
    </section>
</main>

<a href="/usuarios/add" class="add-btn-float">
    <i class="fa fa-plus fbtn-float"></i>
</a>

<script>
    window.onload = function () {
        $("#gerarExcel").click(function (e) {
            var a = document.createElement('a');
            var data_type = 'data:application/vnd.ms-excel';
            var table_div = document.getElementById('tabelaUsuarios');
            var table_html = table_div.outerHTML.replace(/ /g, '%20');
            a.href = data_type + ', ' + table_html;
            a.download = 'usuarios_cadastrados.xls';
            a.click();
            e.preventDefault();
        });
    }
  </script>